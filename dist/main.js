!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CFD=e():t.CFD=e()}(this,(()=>{return t={965:(t,e,o)=>{const s=o(182);t.exports=function(t){return t.prototype.httpClient=async function(t){try{const{url:e,body:o,...i}=t,n=new URL(e,s.get("baseUrl")).href,r=await fetch(n,{headers:{"X-API-KEY":s.get("apiKey"),"Content-Type":"application/json"},body:JSON.stringify(o),...i});return await r.json()}catch(t){throw console.error("Error:",t),t}},t}},182:t=>{t.exports=function(t={}){return{config:t,reset:function(t={}){this.config=t},set:function(t){return this.config={...this.config,...t},this.config},get:function(t){return this.config[t]}}}({baseUrl:"https://decision-api-dot-customerforge-prod.ts.r.appspot.com/api/v1/decision/",socketUrl:""})},138:(t,e,o)=>{const s=o(295),i=o(926),n=o(182),r=function(t,e={}){const{socketUrl:o,baseUrl:s}=e;this.socketUrl=o||n.get("socketUrl"),this.baseUrl=s||n.get("baseUrl"),this.apiKey=t,n.set({apiKey:t,baseUrl:this.baseUrl,socketUrl:this.socketUrl}),this.profileId=null,this.user_id=null,""===this.socketUrl?this.ws=null:this.ws=this._ws(t)};r.prototype._ws=function(t,e){const o={apiKey:t,...e&&{profileId:e}};return new URL(this.socketUrl).searchParams.set("q",encodeURIComponent(btoa(JSON.stringify(o)))),this.ws&&this.ws.close(),this.ws},r.prototype.track=async function(t){const e=new s(this.profileId);await e.track(t)},r.prototype.identify=async function(t,e,o={}){const s=new i,n=await s.identify(t||this.user_id,e,o);return this.profileId=n._id,this.user_id=n.user_id,this._ws(this.apiKey,this.profileId),this.profileId},r.prototype.recommend=function(t){},r.prototype.onJourneyCompletion=function(t,e){this.ws&&this.ws.addEventListener("message",(e=>{t(JSON.parse(e.data))}))},r.prototype.onDestinationResponse=function(t,e){this.ws&&this.ws.addEventListener("message",(e=>{t(JSON.parse(e.data))}))},t.exports=r},295:(t,e,o)=>{const s=o(965),i=function(t){this.profileId=t};i.prototype.track=async function(t,e={}){if(!this.profileId)throw new Error("ProfileId is missing");return this.httpClient({url:`interactions/${this.profileId}`,method:"POST",body:{event:t,...e}})},t.exports=s(i)},926:(t,e,o)=>{const s=o(965),i=function(t){this.profileId=t};i.prototype.identify=async function(t,e,o){const s=await this.httpClient({url:"profiles/identify",method:"POST",body:{...t?{user_id:t}:null,user_properties:o,...e?{segment:e}:null}});return this.profileId=s._id,s},t.exports=s(i)}},e={},function o(s){var i=e[s];if(void 0!==i)return i.exports;var n=e[s]={exports:{}};return t[s](n,n.exports,o),n.exports}(138);var t,e}));