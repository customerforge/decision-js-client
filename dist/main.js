!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CFD=e():t.CFD=e()}(this,(()=>{return t={965:(t,e,o)=>{const i=o(182);t.exports=function(t){return t.prototype.httpClient=async function(t){try{const{url:e,body:o,...s}=t,n=new URL(e,i.get("baseUrl")).href,r=await fetch(n,{headers:{"X-API-KEY":i.get("apiKey"),"Content-Type":"application/json"},body:JSON.stringify(o),...s});return await r.json()}catch(t){throw console.error("Error:",t),t}},t}},182:t=>{t.exports=function(t={}){return{config:t,reset:function(t={}){this.config=t},set:function(t){return this.config={...this.config,...t},this.config},get:function(t){return this.config[t]}}}({baseUrl:"http://localhost:3000/api/v1/decision/",socketUrl:"ws://localhost:8080"})},138:(t,e,o)=>{const i=o(295),s=o(926),n=o(182),r=function(t,e={}){const{socketUrl:o,baseUrl:i}=e;this.socketUrl=o||n.get("socketUrl"),this.baseUrl=i||n.get("baseUrl"),this.apiKey=t,n.set({apiKey:t,baseUrl:this.baseUrl,socketUrl:this.socketUrl}),this.profileId=null,this.user_id=null,this.ws=this._ws(t)};r.prototype._ws=function(t,e){let o=new URL(this.socketUrl);const i={apiKey:t,...e&&{profileId:e}};return o.searchParams.set("q",encodeURIComponent(btoa(JSON.stringify(i)))),this.ws&&this.ws.close(),this.ws=new WebSocket(o),this.ws},r.prototype.track=async function(t){const e=new i(this.profileId);await e.track(t)},r.prototype.identify=async function(t,e,o={}){const i=new s,n=await i.identify(t||this.user_id,e,o);return this.profileId=n._id,this.user_id=n.user_id,this._ws(this.apiKey,this.profileId),this.profileId},r.prototype.recommend=function(t){},r.prototype.onJourneyCompletion=function(t,e){this.ws.addEventListener("message",(e=>{t(JSON.parse(e.data))}))},r.prototype.onDestinationResponse=function(t,e){this.ws.addEventListener("message",(e=>{t(JSON.parse(e.data))}))},t.exports=r},295:(t,e,o)=>{const i=o(965),s=function(t){this.profileId=t};s.prototype.track=async function(t,e={}){if(!this.profileId)throw new Error("ProfileId is missing");return this.httpClient({url:`interactions/${this.profileId}`,method:"POST",body:{event:t,...e}})},t.exports=i(s)},926:(t,e,o)=>{const i=o(965),s=function(t){this.profileId=t};s.prototype.identify=async function(t,e,o){if(!t)throw new Error("user_id is missing");const i=await this.httpClient({url:"profiles/identify",method:"POST",body:{user_id:t,user_properties:o,...e?{segment:e}:null}});return this.profileId=i._id,i},t.exports=i(s)}},e={},function o(i){var s=e[i];if(void 0!==s)return s.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,o),n.exports}(138);var t,e}));